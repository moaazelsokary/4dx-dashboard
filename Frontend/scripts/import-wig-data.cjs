require('dotenv').config({ path: '.env.local' });
const sql = require('mssql');
const fs = require('fs');
const path = require('path');

// Parse server and port
const getEnv = (key) => {
  const value = process.env[key];
  return value ? value.trim().replace(/^["']|["']$/g, '') : undefined;
};

const serverValue = getEnv('SERVER') || getEnv('VITE_SERVER') || '';
let server, port;
if (serverValue.includes(',')) {
  [server, port] = serverValue.split(',').map(s => s.trim());
  port = parseInt(port) || 1433;
} else {
  server = serverValue;
  port = 1433;
}

const config = {
  server: server,
  port: port,
  database: getEnv('DATABASE') || getEnv('VITE_DATABASE'),
  user: getEnv('UID') || getEnv('VITE_UID') || getEnv('VIE_UID') || getEnv('VITE_USER'),
  password: getEnv('PWD') || getEnv('VITE_PWD'),
  options: {
    encrypt: true,
    trustServerCertificate: true,
    enableArithAbort: true,
  },
};

// Function to parse annual target - can be number, percentage, or text
function parseAnnualTarget(value) {
  if (!value || value.trim() === '') return 0;
  
  const cleaned = value.toString().trim().replace(/,/g, '');
  
  // Handle percentages
  if (cleaned.includes('%')) {
    return parseFloat(cleaned.replace('%', '')) || 0;
  }
  
  // Handle "M" for millions
  if (cleaned.toUpperCase().includes('M')) {
    const num = parseFloat(cleaned.replace(/[Mم]/gi, '')) || 0;
    return num * 1000000;
  }
  
  // Handle "K" for thousands
  if (cleaned.toUpperCase().includes('K')) {
    const num = parseFloat(cleaned.replace(/[Kك]/gi, '')) || 0;
    return num * 1000;
  }
  
  // Try to parse as number
  const num = parseFloat(cleaned);
  if (!isNaN(num)) {
    return num;
  }
  
  // If it's text (like "7 ايام", "2 new platform"), return 0 but we'll store the text
  return 0;
}

async function importWIGData() {
  try {
    console.log('Connecting to SQL Server...');
    const pool = await sql.connect(config);
    console.log('✅ Connected to SQL Server');

    // The data provided by user
    const data = `Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.1	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.1.1	عدد المتطوعين المسجلين تراكميا	35,000
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.1	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.1.2	عدد المتطوعين الذين شاركوا بفرصة تطوعية واحدة على الأقل سنويا ( 60 % )	17,000
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.1	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.1.3	عدد المتطوعين النشطين ( مشاركة بعدد 5 فرص تطوعية على الأقل كل 3 شهور ولمدة سنة) – 50 % من المشاركين	8,000
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.1	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.1.4	تمثيل الفئات المهمشة (ذوي الإعاقة) 	0.50%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.1	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.1.5	 معدل رضا المتطوع عن التجربة التطوعية في صناع	70.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.2	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.2.1	نسبة المتطوعين الحاصلين على تدريبات اساسية من المتطوعين النشطين - سنويا	50.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.2	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.2.2	عدد المتطوعين الحاصلين على تدريبات متقدمة من المتطوعين النشطين - سنويا	10.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.2	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.2.3	عدد المتطوعين المؤهلين للقيادة التطوعية - سنويا	6.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.1	عدد الفرص التطوعية المتاحة سنويا	200,000
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.2	معدل الفرص التطوعية التي تم تفعيلها من المتاح – 80% من المتاح	80.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.3	نسبة الفرص التطوعية التي تمت اتاحتها من خلال شراكات مع جهات أخري فيما عدا المشاريع	0
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.4	متوسط وقت اسناد الفرصة للمتطوع ( الوقت بين التسجيل على الفرصة وتفعيل المتطوع )بالساعات افضل	7 ايام
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.5	عدد الفرص التطوعية المدارة رقميا من خلال صناع الحياة – 20% من المتاح	20.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.6	عدد المبادرات التطوعية المرشحة من متطوعين وتم تبنيها من المؤسسة ( مبادرة يتم تفعيل 10 متطوعين فيها على الأقل )	120
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.3	تنمية قاعدة المتطوعين وتوسيع قاعدة الانتشار	1.3.7	القيمة الاقتصادية لساعة التطوع ( عدد ساعات التطوع * قيمة الساعه في السوق )	55
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.4	تعظيم الأثر المجتمعي لأنشطة المتطوعين	1.4.1	عدد المستفيدين المباشرين من الفرص التطوعية	1M
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.4	تعظيم الأثر المجتمعي لأنشطة المتطوعين	1.4.2	عدد قصص النجاح التي افتخرت صناع الحياة بانتساب متطوعيها لهم خلال مرورهم برحلة التطوع عبر صناع الحياة خلال رحلتهم التطوعية	10
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.4	تعظيم الأثر المجتمعي لأنشطة المتطوعين	1.4.3	نسبة رضا المستفيدين عن الخدمات المقدمة من المتطوعين	50.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.1	عدد الأنشطة الترفيهية/الثقافية/الإبداعية السنوية (رياضة – مسرح – غناء – ورش إبداع)	20
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.2	نسبة المتطوعين المشاركين في الأنشطة غير الرسمية من إجمالي المتطوعين	0
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.3	عدد الفرق الرسمية (رياضية/فنية) التابعة للمؤسسة	2
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.4	عدد المتطوعين المشاركين في المصيف السنوي	600
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.5	عدد الرحلات السنوية للمتطوعين (داخلية/خارجية	2
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.6	معدل بقاء المتطوعين أكثر من سنتين	20.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.7	معدل رضا المتطوعين عن الأنشطة (استبيان سنوي)	70.00%
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.8	عدد برامج التبادل التطوعي الدولي المنفذة سنويًا	1
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.9	عدد المتطوعين المصريين الموفدين للتبادل سنويًا	10
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.10	عدد المتطوعين الدوليين المستضافين في مصر سنويًا	5
Strategic Themes	1	تعزيز منظومة العمل التطوعي	1.5	تعزيز تجربة المتطوعين ورفاهيتهم	1.5.11	عدد الشراكات الدولية مع منظمات تطوعية/مؤسسات في أوروبا	2
Strategic Themes	2	المشروعات التنموية	2.1	رفع حجم ومعدل مساهمة المؤسسة في المشروعات التنموية	2.1.1	إجمالي حجم الإنفاق على المشروعات التنموية مقابل الخيرية (بالقيمة والنسبة المئوية).	29.00%
Strategic Themes	2	المشروعات التنموية	2.1	رفع حجم ومعدل مساهمة المؤسسة في المشروعات التنموية	2.1.2	عدد المشروعات التنموية 	17
Strategic Themes	2	المشروعات التنموية	2.1	رفع حجم ومعدل مساهمة المؤسسة في المشروعات التنموية	2.1.3	عدد المستفيدين من المشروعات التنموية	              1,180,000
Strategic Themes	2	المشروعات التنموية	2.1	رفع حجم ومعدل مساهمة المؤسسة في المشروعات التنموية	2.1.4	عدد المستفيدين من المشروعات الخيرية	              2,405,100
Strategic Themes	2	المشروعات التنموية	2.1	رفع حجم ومعدل مساهمة المؤسسة في المشروعات التنموية	2.1.5	نسبة المتطوعين المشاركين في المشروعات التنموية	40٪
Contributors	3	تعزيز العلامة المؤسسية لمؤسسة صُنّاع الحياة	3.1	بناء صورة ذهنية قوية للمؤسسة	3.1.1	مستوى الوعي بالعلامة المؤسسية (Brand Awareness)	
Contributors	3	تعزيز العلامة المؤسسية لمؤسسة صُنّاع الحياة	3.1	بناء صورة ذهنية قوية للمؤسسة	3.1.2	حجم التفاعل الرقمي (عدد المتابعين – معدلات التفاعل – المشاركات).	
Contributors	3	تعزيز العلامة المؤسسية لمؤسسة صُنّاع الحياة	3.1	بناء صورة ذهنية قوية للمؤسسة	3.1.3	مؤشر السمعة المؤسسية Net Promoter Score NPS خلال تقييم دوري للجمهور والشركاء.	
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.1	عدد الشراكات المحلية ( شركات – بنوك - .... )	8
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.2	عدد الشراكات مع المنظمات الدوليه	10
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.3	عدد الشراكات مع المنظمات المحلية	7
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.4	عدد الشراكات مع المؤسسات الحكومية	15
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.5	عدد الشراكات القاعدية	300
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.6	عدد رجال الاعمال الداعمين	2
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.7	عدد الشركاء الاستراتيجيين الممولين لأكثر من مشروع	8
Contributors	4	بناء علاقات وشراكات طويلة المدي	4.1	بناء وإدارة شبكة علاقات استراتيجية فعّالة	4.1.8	قيمة التمويل الناتج عن الشراكات  (مليون)	180
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.1	عدد مذكرات التفاهم و اتفاقيات الشراكة الموقعة مع منظمات دولية	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.3	عدد المستفيدين المباشرين من المشروعات	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.4	معدل الصرف فى المشروعات  Burn Rate	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.5	حجم التمويل لتلك المنح	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.6	عدد المساهمات البحثية أو الدراسات أو قصص النجاح المنشورة دوليًا حول تجربة صُنّاع الحياة في ملف اللاجئين	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.7	عدد المتطوعين المشاركين	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.8	عدد مذكرات التفاهم أو الخطابات الرسمية المؤيدة / عدد الوزارات أو الجهات الحكومية المشاركة	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.1	ترسيخ مكانة صناع الحياة كشريك تنفيذي استراتيجي يقود تنفيذ البرامج الدولية في مصر مع التركيز علي دعم العائدين من الخارج واللاجئين	5.1.9	عدد الشراكات مع القطاع الخاص فى الملف	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.1	عدد الأشخاص الذين وصلت إليهم رسائل التوعية (مباشر وغير مباشر)	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.2	عدد الوظائف و التدريبات الوظيفية التى حصل عليها ذوى الإعاقة	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.3	عدد الفعاليات الدامجة المنفذة على مستوى الجمهورية	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.4	معدل الصرف فى المشروعات  Burn Rate	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.5	حجم التمويل	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.6	عدد المشاركين من ذوى الإعاقة فى مسابقة وطنية سنوية لمواهب ذوى الإعاقة	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.7	عدد المتطوعين الذين كونوا صداقات مع ذوى الإعاقة	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.8	عدد المتطوعين المشاركين	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.9	عدد الشراكات (قطاع خاص – دولى)	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.2	تعزيز ريادة صُنّاع الحياة في دعم وتمكين الأشخاص ذوي الإعاقة اجتماعيًا واقتصاديًا".	5.2.10	عدد مذكرات التفاهم أو الخطابات الرسمية المؤيدة / عدد الوزارات أو الجهات الحكومية المشاركة	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.1	تصميم وتنفيذ حملات وطنية سنوية حول قضايا المجتمع	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.2	عدد المواطنين الذين تم الوصول إليهم	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.3	عدد المواطنين الذين تم توعيتهم	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.4	عدد المتطوعين المدرَّبين على المناصرة والتوعية	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.6	حجم التمويل	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.7	عدد المتطوعين المشاركين فى حملات التوعية	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.8	عدد الشراكات (قطاع خاص – دولى)	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.3	تعزيز وعي المجتمع المصري بالقضايا التنموية والإنسانية من خلال حملات وطنية يقودها الشباب والمتطوعون	5.3.9	عدد مذكرات التفاهم أو الخطابات الرسمية المؤيدة / عدد الوزارات أو الجهات الحكومية المشاركة	
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		عدد المشتركيين في كل مستوي 	300 مشترك 
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		عدد الشركاء ( مدارس - جامعات - مجتمع صناع الحياة )	5 مدارس 
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		نسبة رضا المشتركين 	80% رضا  
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		عدد المشاركات في إيفنتات شبابية 	4 ايفنتات 
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		زيادة عدد متابعين الصفحة 	25,000
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		عمل 2 ايفنت 	2000 مشارك
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		عدد قنوات سوشيال ميديا 	2 new platform 
Contributors	5	تحقيق الريادة في الملفات الاستراتيجية	5.4	دوق ادنبرة : تمكين الشباب و بناء قدراتهم الحياتية و القيادية		عدد مشتركين من ذوي الإعاقة 	20مشترك 
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.1	عدد الجهات المانحة سنويًا (محلية – إقليمية – دولية )	24
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.2	إجمالي حجم الأعمال السنوى للمؤسسة (مليون جنيه ) غير شامل العينى	550
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.3	إجمالي حجم الأعمال السنوى للمؤسسة (مليون جنيه ) شامل العينى	700
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.4	حجم التمويل من Unrestricted Funds (أرباح الشركة + العائد من النخيل + العائد من الكلى + فوائد البنوك + مصادر اخرى)	75
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.5	حجم التمويل من المنح	250
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.6	حجم التمويل الفردى	300
Strategic Enablers	6	تعزيز الاستدامة المالية وتنويع مصادر التمويل	6.1	زيادة حجم التمويل المستدام	6.1.7	حجم التمويل الغير مقيد من أجمالى التمويل الفردى	75
Strategic Enablers	7	التميز التشغيلي والكفاءة (Operational Excellence )	7.1	تحسين الكفاءة الإدارية والمالية، وضمان الاستخدام الأمثل للموارد بما يحقق أعلى عائد مجتمعي	7.1.1	نسبة المصروفات الإدارية إلى إجمالي العائد/الدخل ( Administrative Expenses Ratio)	13.00%
Strategic Enablers	7	التميز التشغيلي والكفاءة (Operational Excellence )	7.1	تحسين الكفاءة الإدارية والمالية، وضمان الاستخدام الأمثل للموارد بما يحقق أعلى عائد مجتمعي	7.1.2	نسبة تغطية المصروفات الإدارية من مساهمات الشركات	30.00%
Strategic Enablers	7	التميز التشغيلي والكفاءة (Operational Excellence )	7.1	تحسين الكفاءة الإدارية والمالية، وضمان الاستخدام الأمثل للموارد بما يحقق أعلى عائد مجتمعي	7.1.3	زمن إنجاز المعاملات الإدارية الأساسية	4
Strategic Enablers	7	التميز التشغيلي والكفاءة (Operational Excellence )	7.1	تحسين الكفاءة الإدارية والمالية، وضمان الاستخدام الأمثل للموارد بما يحقق أعلى عائد مجتمعي	7.1.4	نسبة امتثال المؤسسة الي تطبيق مفهوم الاستدامة	20.00%
Strategic Enablers	7	التميز التشغيلي والكفاءة (Operational Excellence )	7.1	تحسين الكفاءة الإدارية والمالية، وضمان الاستخدام الأمثل للموارد بما يحقق أعلى عائد مجتمعي	7.1.5	نسبة الموظفين الحاصلين على تدريبات أساسية في وظائفهم سنويًا	
Strategic Enablers	7	التميز التشغيلي والكفاءة (Operational Excellence )	7.1	تحسين الكفاءة الإدارية والمالية، وضمان الاستخدام الأمثل للموارد بما يحقق أعلى عائد مجتمعي	7.1.6	نسبة الموظفين الحاصلين على تدريبات متقدمة مرتبطة بمهامهم التشغيلية	
Strategic Enablers		قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1	قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1.1	مستوى تطبيق الأنظمة والعمليات الداخلية المعيارية بشكل رقمي SOPs	
Strategic Enablers		قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1	قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1.2	معدل الأتمتة والرقمنة في العمليات الإدارية والمالية والموارد البشرية.	
Strategic Enablers		قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1	قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1.3	نسبة القرارات الإدارية المبنية على تحليلات الذكاء الاصطناعي Decision Based on AI	
Strategic Enablers		قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1	قيادة التحول الرقمي ودمج الذكاء الاصطناعي	8.1.4	عدد حلول الذكاء الاصطناعي المدمجة في أنظمة المؤسسة  (Chatbots – Predictive Analytics – Data Visualization	
Strategic Enablers		Fix The Fundamentals إصلاح الاساسيات	9.1	تطوير وتطبيق أنظمة وإجراءات معيارية SOPsواتفاقيات مستوى الخدمة SLAs	9.1.1	عدد/نسبة الأقسام التي طبقت SLA	50.00%
Strategic Enablers		Fix The Fundamentals إصلاح الاساسيات	9.1	تطوير وتطبيق أنظمة وإجراءات معيارية SOPsواتفاقيات مستوى الخدمة SLAs	9.1.2	نسبة الالتزام بالتقارير الدورية عن تطبيق الـ SOPs	100.00%`;

    const lines = data.split('\n').filter(line => line.trim());
    console.log(`Parsing ${lines.length} lines...`);

    let inserted = 0;
    let skipped = 0;

    for (const line of lines) {
      const parts = line.split('\t').map(p => p.trim());
      
      if (parts.length < 8) {
        console.log(`⚠️  Skipping line (insufficient columns): ${line.substring(0, 50)}...`);
        skipped++;
        continue;
      }

      const pillar = parts[0] || '';
      const objectiveNum = parts[1] || '';
      const objective = parts[2] || '';
      const targetNum = parts[3] || '';
      const target = parts[4] || '';
      const kpiNum = parts[5] || '';
      const kpi = parts[6] || '';
      const annualTargetRaw = parts[7] || '';

      // Skip if essential fields are missing
      if (!pillar || !objective || !target || !kpi) {
        console.log(`⚠️  Skipping line (missing essential fields): ${line.substring(0, 50)}...`);
        skipped++;
        continue;
      }

      const annualTarget = parseAnnualTarget(annualTargetRaw);

      // Combine numbers with text for target and KPI (numbers are stored as prefixes)
      const targetWithNum = targetNum ? `${targetNum} ${target}` : target;
      const kpiWithNum = kpiNum ? `${kpiNum} ${kpi}` : kpi;

      try {
        // Create a new request for each insert
        const request = pool.request();
        request.input('pillar', sql.NVarChar, pillar);
        request.input('objective', sql.NVarChar, objective);
        request.input('target', sql.NVarChar, targetWithNum);
        request.input('kpi', sql.NVarChar, kpiWithNum);
        request.input('annual_target', sql.Decimal(18, 2), annualTarget);

        await request.query(`
          INSERT INTO main_plan_objectives (pillar, objective, target, kpi, annual_target)
          VALUES (@pillar, @objective, @target, @kpi, @annual_target)
        `);

        inserted++;
        if (inserted % 10 === 0) {
          console.log(`✅ Inserted ${inserted} records...`);
        }
      } catch (error) {
        if (error.message.includes('duplicate') || error.message.includes('UNIQUE')) {
          console.log(`⚠️  Skipping duplicate: ${kpi}`);
          skipped++;
        } else {
          console.error(`❌ Error inserting: ${kpi}`, error.message);
          throw error;
        }
      }
    }

    console.log(`\n✅ Import completed!`);
    console.log(`   Inserted: ${inserted} records`);
    console.log(`   Skipped: ${skipped} records`);
    
    await pool.close();
  } catch (error) {
    console.error('❌ Import failed:', error.message);
    if (error.code) {
      console.error('Error code:', error.code);
    }
    process.exit(1);
  }
}

importWIGData();

